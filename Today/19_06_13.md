TIL :: 19_06_13

# TODO
- kubernetes
  - [x] kubernetes ALB ingress controller check
  - [ ] 기존 배포 흐름 이해
  - [ ] kubernetes 배포 흐름에 녹여보기

  - [x] kiam 설정해보기
  - [ ] offline에서 aws-iam-authenticator 테스트하기
  - [ ] eks 질문 리스트 작성
  - [ ] eks external snat 테스트 해보기
  - [ ] 사설 ca 등록하는 방법

  - [x] kubernetes 모니터링 EFK
  - [ ] node의 /var/lib/docker 용량이 부족했을 때의 노티 -> metric beat 사용해보기
  - [x] elasticsearch opensource auth 기능 검토
  - [ ] fluentd로 컨테이너 별 es index 할 수 있는지 검토
  - [ ] fluentd에 es id/pass secret으로 빼기
  - [ ] es statefulSet으로 올리기
  - [ ] grafana에서 es 얹어보기

- PIR
  - [x] 서버 지급 확인
  - [ ] 계정신청
  - [ ] 로그인 기능
  - [ ] incident create시 iam api 연동
  - [ ] incident create시 incident num
  - [ ] incident detail history 보여 주기

- BACKLOG
  - [ ] vpc ip 부족할 시 noti 받아보기
  - [ ] aws eks에서 networkPolicy 동작 잘하는지 체크
  - [x] kubeconfig에서 ec2 role 사용하기
  - [ ] helm TLS

- Question
  - [ ] aws EKS의 client CA는 수정 가능?
  - [ ] amazon-vpc-cni-k8s 동작 방식
  - [ ] worker의 eni가 부족했을 때 알람 받는 방법



# linux 교육
- /etc/passwd에 계정정보 (비밀번호는 원래 있었으나 지금은 x로 표시) -> 비번은 /etc/shadow
- 계정종류
  - 특권계정
    - uid = 0, root, 쉘 프롬프트가 #
  - 일반계정
    - 쉘 프롬프트가 $
- uid 0~99는 시스템에 의해 할당
- uid 100~499 관리 목적으로 할당

```bash
$ ls -alR  // recursive
$ man ls
```

- file mode
  - 10개의 글자
  - 첫번째는 포맷
  - 2-4 소유자의 permission (rwx :: x는 디렉터리인 경우 이동가능 여부, w는 디렉터리인 경우 하위 파일의 쓰기 권한, rwx = 111: 7)
  - 5-7 그룹 유저의 permission
  - 나머지는 어너미어스
```bash
$ chmod -R 500 test.xml
$ chown -R root:root test.xml
$ chgrp -R
```

```bash
/bin : 사용자용 기본 명령어
/sbin : 시스템 관리자 기본 명령어
/etc : 설정 파일
/var : 로그파일
/tmp : 임시
/usr : 사용자 프로그램
/home : 홈데렉터리
/boot : 부트 로더 파일
/lib : 시스템 라이브러리 
```

- 현재 실행중인 프로세스 ```ps```
  - -e : 모든
  - -f : 상세
  - -H : 계층구조
  - -w : 적당히 보기
  - -ww : 전체 다 보기

  - ppid는 parent process id
  - ```ps aux``` : 프로세스 상태를 관찰하고 싶다할 때 ( STAT )
    - S : interruptible sleep, 언제든 깨어날 수 있다 sleep
    - s : 세션의 리더 상태
    - D : uninterruptible sleep
    - Z : 좀비
  - ```ps -efH```

- 프로세스 죽이기
  - kill pid : SIGTERM 날리기 -> 종료 절차
  - kill -9 pid : 그냥 당장 죽어
- foreground & background
  - ```jobs``` : sleep 프로세스 리스트업
  - ```fg %[JOB NUM]```
  - ```bg %[JOB NUM]```

```bash
$ cat -n eks.tf
$ cp -p :: 원본의 형상을 그대로 유지
```

- 심볼릭 링크 
  - ln -s A symA

```bash
cat text.xml | head -n 4 | tail -n 1
```

- grep
  - -i : 대소문자 구분 x
  - -c : match total count
  - -A : 해당 검색어가 나온 거 이후 몇줄 더 출력
  - -B : 해당 검색어가 나온 거 이전 몇줄 더 출력

- wc
  - -c : 몇 byte
  - -l : line 수

- less
```bash
cat eks.tf | less
스페이스 치면 다음 페이지
ctrl + b 는 이전 페이지
```
